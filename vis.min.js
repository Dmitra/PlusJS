var Vis=function(a){var b=this;if(b._config=b._defaults,"undefined"!=typeof a)for(var c in a)"undefined"!=typeof a[c]&&(b._config[c]=a[c]);b._vis=b._config.target,b._g=b._vis.append("g"),b._setColors=function(a){var c=a.map(function(a){return a.color});b._config.colorCodingMin=b._config.colorCodingMin||d3.min(c),b._config.colorCodingMax=b._config.colorCodingMax||d3.max(c),b._color=d3.scale.linear().domain(b._config.colorCoding||[b._config.colorCodingMin,b._config.colorCodingMax]).range(b._config.colorRange)}};Vis.Radial=function(a){Vis.call(this,a);var b=this;b._rotateRad=2*Math.PI/180*b._config.rotate,b.toRad=d3.scale.linear().range([0,2*Math.PI]),b.toGrad=d3.scale.linear().range([0,360]),b.center=[b._config.width/2,b._config.height/2],b.getCoords=function(a,c,d){d=d||0;var e=b.toRad(d)+b._rotateRad,f=a[0]+c*Math.sin(e),g=a[1]-c*Math.cos(e);return[f,g]},b.draw=function(a){var c=b._config.positionMax?[0,b._config.positionMax]:d3.extent(_.pluck(a,"position"));b.toRad.domain(c),b.toGrad.domain(c),b._setColors(a)}},Vis.Radial.Arc=function(a){var b=this;b._defaults={width:400,height:400,startRadius:30,radius:10,rotate:0,factor:1,colorCodingMin:void 0,colorCodingMax:void 0,colorRange:["violet","red"]},Vis.Radial.call(this,a),b._draw=b.draw,b.draw=function(a){b._draw(a);b._g.selectAll(".arc").data(a).enter().append("path").attr("d",b.arc).attr("class","arc").style("fill",function(a){return b._color(a.color)})},b.arc=d3.svg.arc().startAngle(function(a){return b.toRad(a.position)+b._rotateRad}).endAngle(function(a){return b.toRad(a.position+1)+b._rotateRad}).innerRadius(b._config.innerRadius).outerRadius(b._config.innerRadius+b._config.radius),b._g.attr("transform","translate("+b._config.width/2+","+b._config.height/2+")")},Vis.Radial.Circle=function(a){var b=this;b._defaults={width:400,height:400,rotate:0,factor:1,colorCodingMin:void 0,colorCodingMax:void 0,colorRange:["violet","red"],radius:50,size:0,color:"grey"},Vis.Radial.call(this,a),b._draw=b.draw,b.draw=function(a){b._draw(a),b._g.selectAll(".circle").data(a).enter().append("circle").attr("class","circle").attr("cx",function(a){return b.getCoords(b.center,b._config.radius+a.distance*b._config.factor,a.position)[0]}).attr("cy",function(a){return b.getCoords(b.center,b._config.radius+a.distance*b._config.factor,a.position)[1]}).attr("r",function(a){return a.size||b._config.size}).style("fill",function(a){return a.color?b._color(a.color):b._config.color})}},Vis.Radial.Label=function(a){var b=this;b._defaults={width:400,height:400,rotate:0,factor:1,colorCodingMin:void 0,colorCodingMax:void 0,colorRange:["violet","red"],radius:50,size:10,color:"grey"},Vis.Radial.call(this,a),b._draw=b.draw,b.draw=function(a){b._draw(a),b._g.selectAll(".label").data(a).enter().append("text").attr("class","label").attr("transform",function(a){var c=b.getCoords(b.center,b._config.radius,a.position);return"translate("+c[0]+","+c[1]+") rotate("+b.toGrad(a.position)+")"}).attr("dy",".71em").attr("text-anchor","middle").text(function(a){return a.label})}},Vis.Radial.Ray=function(a){var b=this;b._defaults={width:400,height:400,direction:"out",rotate:0,factor:1,dashed:"10,5",colorCodingMin:void 0,colorCodingMax:void 0,colorRange:["violet","red"],rayLength:0,radius:50},Vis.Radial.call(this,a),b._draw=b.draw,b.draw=function(a){b._draw(a);var c=b._vis.append("defs").append("linearGradient").attr("id","grad1");c.append("stop").attr("offset","0%").attr("stop-color","red"),c.append("stop").attr("offset","100%").attr("stop-color","red").attr("stop-opacity",0);b._g.selectAll(".ray").data(a).enter().append("path").attr("class","ray").attr("stroke-dasharray",b._config.dashed).attr("d",b.ray).attr("class","line").style("stroke",function(a){return b._config.color||b._color(a.color)}).style("stroke-width",b._config.strokeWidth+"px")},b.ray=function(a){var c=a.rayLength||b._config.rayLength,d=b.getCoords(b.center,b._config.radius,a.position),e=b.getCoords(b.center,b._config.radius+c*b._config.factor,a.position);return"M"+d[0]+" "+d[1]+"L"+e[0]+" "+e[1]},b._config.factor="in"===b._config.direction?-b._config.factor:b._config.factor};